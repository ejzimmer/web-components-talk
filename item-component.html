<template id="item-template">
  <style>
    :host {
      display: flex;
      flex-direction: column;
      width: 300px;
      border: 4px solid var(--black);
      padding: 1em;
      border-radius: 8px;
      margin: .5em;       
    }

    *:active, *:focus {
      outline: none;
    }

    h2 {
      font-size: 32px;
      margin-bottom: 8px;
    }

    .picture {
      height: 150px;
      display: flex;
    }
    .picture img {
      align-self: center;
      max-width: 100%;
      max-height: 100%;
      margin: auto;
    }

    .description {
      flex-grow: 1;
    }

    .buy {
      display: flex;
      flex-wrap: wrap;
      margin-top: .5em;
    }
    .buy label {
      margin-bottom: .5em;
    }
    .buy input, .buy button {
      border: 2px solid var(--black);
      border-radius: 8px;
    }

    .buy input {
      width: 10ch;
      padding: .5ch 1ch;
      text-align: right;
      height: 35px;
      margin-right: 1em;
    }

    .buy button {
      background-color: var(--red);
      color: white;
      font-size: 20px;
      width: 4.5ch;
      height: 35px;
      position: relative;
      cursor: pointer;
    }

  </style>
  <div class="item">
    <div class="picture">
      <img id="product-image" />
    </div>
    <h2></h2>
    <div class="description">
      <slot></slot>
    </div>
    <div class="buy">
      <label>
        <span>How many?</span>
        <input type="number" />
      </label>
      <button id="buy">Buy</button>
    </div>
  </div>
</template>

<script>

  // Coding demo: change document to document.currentScript.ownerDocument
  // These are now in global namespace
  class BigDonutItem extends HTMLElement {
    constructor() {
      super();

      this.attachShadow({ mode: 'open' });
      const content = document.currentScript.ownerDocument.getElementById('item-template').content.cloneNode(true);
      this.shadowRoot.appendChild(content);

      const name = this.attributes.name.value; 
      this.shadowRoot.querySelector('h2').innerText = name;

      const image = this.attributes.image.value;
      const imgElement = this.shadowRoot.querySelector('.picture img');
      imgElement.src = image;

      this.input = this.shadowRoot.querySelector('input');
      this.button = this.shadowRoot.getElementById('buy');

      this.button.addEventListener('click', this.onBuy.bind(this));

    }

    onBuy() {
      const quantity = this.input.value;
      alert(quantity);
      this.input.value = '';
    }
  }
  customElements.define('big-donut-item', BigDonutItem);
</script>