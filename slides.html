
<!doctype html>
<html>
  <head>
    <link rel="stylesheet" href="reveal/reveal.css">
    <link rel="stylesheet" href="shared.css" />
		<link rel="stylesheet" href="slides.css" />
		<link rel="stylesheet" href="zenburn.css" />

		<script src="reveal/reveal.js"></script>

		<script>
			const isNextSlide = key => key === 'PageDown' || key === 'ArrowRight' || key === ' ';
		</script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
	      <section>
				<h1>Web Components</h1>
				<div class="subtitle">It's about time.</div>
				</section>
				<section data-background-image="images/Steven_Universe_title.jpg">
				</section>
				<section>
					<div style="display: flex; justify-content: space-evenly; width: 100%">
						<figure style="display: flex; flex-direction: column; align-items: center">
						<img src="images/web-components-logo.png" style="width: 100%" />
						<figcaption style="font-size: .9em; font-family: sans-serif">
							WEB COMPONENTS
						</figcaption>
					</figure>
					<div style="width: 40%">
						<div class="notes">Allow you to create new HTML elements that are</div>
						<ul>
							<li class="fragment">Custom</li>
							<li class="fragment">Reusable</li>
							<li class="fragment">Encapsulated</li>
						</ul>
					</div>
					</div>
				</section>
				<section>
					<div class="specs-grid">
						<div class="html-template"></div>
						<div class="custom-element"></div>
						<div class="shadow-dom"></div>
						<div class="html-import"></div>
					</div>
					<img src="images/Alexandrite.png" class="fragment" style="position: fixed; top: 0; left: 20%" />
				</section>
				<section>
					<div class="notes">
						Back in 2011, Alex Russell presented a proposal for web components (and some other stuff)
						at Fronteers in Holland. You can watch it here, if you want. 
						Talks about reasons for web components
						It's... long.
						And, really, the proposal didn't get much traction when it was first presented.
					</div>
					<img src="images/proposal-video.png" class="border" style="margin-bottom: 1em; width: 100%" />
					<a style="font-size: .7em; font-family: Arial; position: relative; transform: scale(.9); color: var(--yellow); bottom: 3.5em" 
						class="fragment"
						href="https://fronteers.nl/congres/2011/sessions/web-components-and-model-driven-views-alex-russell">
						https://fronteers.nl/congres/2011/sessions/web-components-and-model-driven-views-alex-russell
					</a>
				</section>
				<section class="framework-logos">
					<img src="images/angular-logo.png" />
					<img src="images/react-logo.png" />
					<img src="images/vue-logo.png" />
					<div class="notes">
						Some important things have changed since 2011
						Everything is components now
					</div>
					<div class="notes">
						Web components aren't really a replacement for your framework components
						There are still a couple of things that frameworks do better
					</div> 
				</section>
				<section>
					 <pre style="font-size: 1.5em"><code class="xml"><div>Hello, {{ name }}</div></code></pre>
					 <div class="notes">
							Interpolation (with a differing number of curly braces depending on which framework you're using)
						</div>
				 </section>
				<section>
					 <pre style="font-size: .8em"><code class="javascript">document.querySelector('#hello').textContent = `Hello, ${name}`</code></pre>
					 <div class="notes">
						 You can do it with web components, it's just a bit more involved, and you have to write a bit of JavaScript.
					 </div>
				</section>
				<section>
					<pre style="font-size: 2em"><code>render()</code></pre>
					<div class="notes">
						You're also not going to get the automatic change detection you do in Angular & Vue,
						or even the manual DOM updating that you get in React. You're basically going to need
						to write your own render() function.
					</div>
				</section>
				<section>
					<pre><code class="xml">&lt;MyAwesomeComponent config="configOptions" /&gt;</code></pre>
					<div class="notes">
						You also can't pass objects in as attributes like you could with a framework component
						You can only pass strings
					</div>
				</section>
				<section data-state="framework-or-web-component">
<pre class="should-i-web-component">
 <span class="framework highlight-0">&lt;app-root&gt;</span>
  <span class="framework highlight-1">&lt;container-component&gt;</span>
   <span class="framework highlight-2">&lt;presentation-component&gt;</span>
    <span class="web-component highlight-3">&lt;div&gt;</span>
     <span class="web-component highlight-3">&lt;label&gt;&lt;/label&gt;</span>
     <span class="web-component highlight-3">&lt;input /&gt;</span>
    <span class="web-component highlight-3">&lt;/div&gt;</span>
   <span class="framework highlight-2">&lt;/presentation-component&gt;</span>
   <span class="web-component-maybe highlight-2">&lt;presentation-component&gt;</span>
   <span class="web-component-maybe highlight-2">&lt;/presentation-component&gt;</span>
  <span class="framework highlight-1">&lt;/container-component&gt;</span>
 <span class="framework highlight-0">&lt;/app-root&gt;</span>
</pre>
					<script>
						Reveal.addEventListener('framework-or-web-component', () => {
							let index = 0;

							function removeHighlighting() {
								document.querySelectorAll('.should-i-web-component span')
									.forEach(element => element.classList.remove('dimmed'));
							}

							function highlightNext() {
								removeHighlighting();
								document.querySelectorAll(`.should-i-web-component span:not(.highlight-${index++})`)
									.forEach(element => element.classList.add('dimmed'));
							}

							function changeColour(selector, colour) {
								document.querySelectorAll(`.should-i-web-component ${selector}`)
											.forEach(element => element.style.color = `var(--${colour})`)
							}

							function listener(event) {
								if (isNextSlide(event.key)) {
									event.stopPropagation();

									if (index < 4) {
										highlightNext();
									}

									else if (index === 4) {
										removeHighlighting();
										changeColour('.web-component', 'yellow');
										index++;
									}

									else if (index === 5) {
										changeColour('.web-component-maybe', 'yellow');
										index++;
									}

									else if (index == 6) {
										changeColour('.framework', 'red');
										index++;
									}

									if (index > 6) {
										document.body.removeEventListener('keydown', listener);
									}
								}
							}

							document.body.addEventListener('keydown', listener);

						});
					</script>
				</section>
				<section data-background-image="Big_Donut.png">
					<a class="card" href="big-donut.html" target="blank">Big Demo</a>
				</section>
				<section>
					<h2>HTML Templates</h2>
					<img src="images/templates.svg" style="width: 40vw" />
				</section>
				<section>
					<div style="display: flex; align-items: center">
						<ol>
							<li>Create a reusable template using <code>&lt;template&gt;&lt;/template&gt;</code></li>
							<li>Clone the template</li>
							<li>Attach the clone to the DOM</li>
						</ol>
						<img src="images/holo-pearl.jpg" style="width: 50%" />
					</div>
				</section>
				<section>
					<pre><code class="xml"><template id="buy-template">
 <div class="buy">
  <label>
    <span>How many?</span>
    <input type="number" />
  </label>
  <button>Buy</button>
 </div>
</template></code></pre>
				</section>
				<section data-background-image="images/pearl-to-action.jpg">
					<div class="card light">Demo!</div>
				</section>
	       <section>
					<img src="images/caniuse-templates.png" class="border" />
					<div class="notes">
						explanation of IE and opera mini
					</div>
	       </section>
	       <section data-state="template-summary">
	         <div style="display: flex">
             <ul id="template-summary" class="clear-list" style="margin: auto; font-size: 2em">
                <li>Custom</li>
                <li class="highlighted">Reusable</li>
                <li>Encapsulated</li>
              </ul>
            </div>
						<script>
							Reveal.addEventListener('template-summary', () => {
								function highlightReusable() {
									document.querySelectorAll('#template-summary li:not(.highlighted)')
									.forEach(li => li.classList.add('dimmed'));
								}
								doOnKeyPress(highlightReusable);
							});
						</script>
	       </section>
	       <section>
	         <div style="display: flex">
  	         <img style="width: 66%" src="images/shadow-dom.svg" />
	           <img src="images/GarnetByKmes.png" />
	         </div>
	         credit for Garnet picture
	       </section>
	       <section>
	         spoiler alert
	         perma-fusion - two different gems on the inside, single united gem on outside
	         picture of ruby and sapphire
	       </section>
	       <section>
	         <div class="notes">
	           Actually, you're probably already familiar with shadow DOM
	         </div>
	         <select>
	           <option>Steven</option>
	           <option>Connie</option>
	           <option>Peridot</option>
	           <option>Pink Diamond</option>
	         </select>
	         <input type="file" />
	         <video></video>
	       </section>
	       <section>
	         <pre><code>
	         <style style="display: block" contenteditable="true">
	           #impervious-checkbox {
	             width: 200px;
	             height: 200px;
	             border-radius: 0;
	             border: initial;
	             background-color: initial;
	             color: blue;
	             font-size: 16px;
	             font-weight: bold;
	           }
	         </style>
	         </code></pre>
	         <input type="checkbox" id="impervious-checkbox" />
	         <div class="notes">
	           Can change width and height, but only to squares
	           Can't change pretty much anything else at all
	           Behaves differently in different browsers (show if time)
	         </div>
	       </section>
	       <section>
	         <div class="notes">
	           checkbox has shield that allows it to repel our CSS
	           steven with shield repelling attack
	         </div>
	       </section>
	       <section>
	         shadow DOM - gives us a DOM that's isolated from the normal DOM
	         Garnet - actually a fusion of two gems, but presents a single API
	         that hides this implementation detail
	         Shadow DOM elements could have multiple elements inside them, but
	         they appear as a single element in the main DOM
	         And, with the new Shadow DOM spec, that power is yours too! (picture of Garnet pointing)
	       </section>
	       <section>
	         <div id="outer-box"></div>
	         <pre><code><style style="display: block">
	           #outer-box {
	             width: 200px;
	             height: 200px;
	             background-color: var(--yellow);
	             display: flex;
	           }
	         </style></code></pre>
	         <pre><code><script style="display: block">
	           const shadow = document.getElementById('outer-box').attachShadow({ mode: 'open' });
	           const inner = document.createElement('div');
	           inner.style.width = '100px';
	           inner.style.height = '100px';
	           inner.style.border = '4px solid var(--red)';
	           inner.style.margin = 'auto';
	           shadow.appendChild(inner);
	         </script></code></pre>
	         <div class="notes">
	           show that we can't target it with js or css
	         </div>
	       </section>
	       <section>
	         <div class="notes">
	           so this is nice and all, but it only works if you build all your DOM in JavaScript
	           wouldn't it be great if there was a way to combine shadow DOM with HTML
	         </div>
	       </section>
	       <section>
	         Sardonyx - HTML templates + Shadow DOM
	       </section>
	       <section>
	         <pre><code>
const template = document.getElementById('buy-template');
const items = document.querySelectorAll('.item');
      
items.forEach((item) => {
  const clone = document.importNode(template.content, true);
  const shadow = item.attachShadow({ mode: 'open' });
  shadow.appendChild(clone);
});
	         </code></pre>
	       </section>
	       <section>
	         <div class="notes">
	           but it gets better! new ability unlocked! html slots
	           something else you've seen before
	         </div>
	       </section>
	       <section>
	         <pre>
	         <style>
	           #clod {
	             border: 4px solid var(--black);
	             border-radius: 5px;
	             width: 75%;
	             background-color: transparent;
	             font-size: 2em;
	             font-family: Riffic;
	             padding: .5em;
	             padding-top: .75em;
	             color: var(--blue);
	           }
		       </style>
	         </pre>
	         <select id="clod">
 	           <option>Steven</option>
	           <option>Connie</option>
	           <option>Peridot</option>
	           <option>Pink Diamond</option>
	         </select>
	       </section>
	       <section>
<pre><code>
<select>
 <option>Steven</option>
 <option>Connie</option>
 <option>Peridot</option>
 <option>Pink Diamond</option>
</select>
</code></pre>
<div class="notes">
  shadow dom + you can pass things into it!
</div>
</section>
	       <section>
	       </section>
	       <section>
<pre><code data-noescape>&lt;div class="item"&gt;
 &lt;div class="picture"&gt;
  &lt;img src="images/<span class="dimmed">donut.png"</span> /&gt;
 &lt;/div&gt;
 &lt;h2&gt;<span class="dimmed">Donut</span>&lt;/h2&gt;
 &lt;div class="description"&gt;
  <span class="dimmed">Exactly what you'd expect at a donut shop</span>
 &lt;/div&gt;
 &lt;div class="buy"&gt;
  &lt;label&gt;
   &lt;span&gt;How many?&lt;/span&gt;
   &lt;input type="number" /&gt;
  &lt;/label&gt;
  &lt;button&gt;Buy&lt;/button&gt;
 &lt;/div&gt;
&lt;/div&gt;
</code></pre>
dim on keypress
better font
syntax highlighting
need to enable code highlighting
	       </section>
	       <section>
<pre><code data-noescape>&lt;div class="item"&gt;
 &lt;div class="picture"&gt;
  &lt;img src="<span style="font-family: Riffic; color: var(--yellow)">???</span>.png" /&gt;
 &lt;/div&gt;
 &lt;h2&gt;<span style="font-family: Riffic; color: var(--yellow)">???</span>&lt;/h2&gt;
 &lt;div class="description"&gt;
  <span style="font-family: Riffic; color: var(--yellow)">???</span>
 &lt;/div&gt;
 &lt;div class="buy"&gt;
  &lt;label&gt;
   &lt;span&gt;How many?&lt;/span&gt;
   &lt;input type="number" /&gt;
  &lt;/label&gt;
  &lt;button&gt;Buy&lt;/button&gt;
 &lt;/div&gt;
&lt;/div&gt;
</code></pre>

	         <div class="notes">
	           Wouldn't it be great if we could create a template with holes in it that we could fill in later
	         </div>
	       </section>
	       <section>
	         template with slots
	         element using slot
	         named vs default slot
	         bit of javascript to tie it all together
	       </section>
	       <section>
	         browser support for slots
	       </section>
	       <section>
	         HTML just contains the content - the styling is abstracted away, just as it should be
	         BUT requires JavaScript every time you want to add a new element to the page, which
	         is not how anyone wants to write HTML
	         What we really want to do is write
	         <pre><code><big-donut-item name="foo" image="bar.png">description</big-donut-item></code></pre>
	       </section>
	       <section>
	         Custom elements & Amethyst
	       </section>
	       <section>
	         Creating your own HTML element is super easy
	       </section>
	       <section>
	         <pre><code>
class MyElement extends HTMLElement {
 constructor() {
  super();
  console.log('custom element created')
 }
}
customElements.define('my-element', MyElement)
	         </code></pre>
	         <!-- <script>
class MyElement extends HTMLElement {
 constructor() {
  super();
  console.log('custom element created');
  this.appendChild(document.createElement('div'));
 }
}
customElements.define('my-element', MyElement)
	         </script>
	         <pre><code><my-element></my-element></code></pre>
	         <my-element></my-element>
	       </section>
	       <section>
	         Unfortunately, we're not allowed to put any DOM elements
	         inside our custom element
	         Demo of adding innerHTML
	         	         <script>
class IllegalElement extends HTMLElement {
 constructor() {
  super();
  console.log('custom element created');
  this.appendChild(document.createElement('div'));
 }
}
customElements.define('illegal-element', IllegalElement)
	         </script> -->
	       </section>
	       <section>
	         Luckily, we know of a way to add stuff inside an element
	         that isn't part of the DOM
	         	         	         <!-- <script>
class ShadowElement extends HTMLElement {
 constructor() {
  super();
  console.log('shadow element created');
  const shadowRoot = this.attachShadow({ mode: 'open' });
  const div = document.createElement('div');
  div.innerHTML = 'hello world';
  shadowRoot.appendChild(div);
 }
}
customElements.define('shadow-element', ShadowElement);
	         </script> -->
	         <shadow-element></shadow-element>
	       </section>
	       <section>
	         
	       </section>
      </div>
		</div>
		<script src="reveal/head.min.js"></script>
		<script>
			Reveal.initialize({
        controls: false,
        progress: false,
				history: true,
				display: 'flex',
				dependencies: [
					{ src: 'reveal/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
				]
			});
		</script>
		<script>
			function doOnKeyPress(callback) {
				function listener(event) {
					if (isNextSlide(event.key)) {
						event.stopPropagation();
						callback();
						document.body.removeEventListener('keydown', listener);
					}
				}
				document.body.addEventListener('keydown', listener);
			}
		</script>						
  </body>
</html>
